This code is assembled from different toolkits. We just provide a code in our pratical use. 
Please reference to orginal code.
read_surf.m is from DPABI_V7.0_230110 (http://rfmri.org/dpabi)
read_annotation.m is from ENIGMA Toolbox (https://enigma-toolbox.readthedocs.io/en/latest/pages/01.install/index.html)
rotate_parcellation.m is from https://github.com/frantisekvasa/rotate_parcellation
spin_map_lh is modfied form the spin_test.m (https://github.com/spin-test/spin-test)
PLS_gene_spin.m and PLS_PANSS_perm.m is modified from https://github.com/SarahMorgan/Morphometric_Similarity_SZ
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The atlas used in this code is from BN_atlas (available at: http://atlas.brainnetome.org/download.html ). 
You can replace with your atlas. 
% This code has been tested in Matlab 2021a.





